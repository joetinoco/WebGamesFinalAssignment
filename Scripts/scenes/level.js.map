{"version":3,"sources":["scenes/level.ts"],"names":[],"mappings":"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","file":"scenes/level.js","sourcesContent":["// MENU SCENE\r\nmodule scenes {\r\n    export class Level extends objects.Scene {\r\n        //PRIVATE INSTANCE VARIABLES ++++++++++++\r\n        private _backgroundImage: createjs.Bitmap;\r\n        private _startButton: objects.Button;\r\n\r\n        // Game Objects\r\n        private _hero: objects.Hero;\r\n        private _enemy: objects.Hero;\r\n        private _exitDoor: objects.ExitDoor;\r\n        //private _scoreboard: objects.Scoreboard;\r\n\r\n        // CONSTRUCTOR ++++++++++++++++++++++\r\n        constructor() {\r\n            super();\r\n        }\r\n\r\n        // PUBLIC METHODS +++++++++++++++++++++\r\n\r\n        // Start Method\r\n        public start(): void {\r\n\r\n            var levelLayout = [\r\n                { x: 0, y: 48, width: 64, height: 1 }, // Floor\r\n                { x: 0, y: 0, width: 1, height: 96 }, // Left wall\r\n                { x: 64, y: 0, width: 1, height: 96 }, // Right wall\r\n\r\n                // Platforms\r\n                { x: 20, y: 43, width: 5, height: 5 },\r\n                { x: 44, y: 43, width: 5, height: 5 },\r\n\r\n                { x: 6, y: 25, width: 5, height: 0.5 },\r\n                { x: 58, y: 25, width: 5, height: 0.5 },\r\n\r\n                { x: 20, y: 12, width: 5, height: 0.5 },\r\n                { x: 44, y: 12, width: 5, height: 0.5 },\r\n\r\n                { x: 32, y: 20, width: 15, height: 0.5 },\r\n\r\n                { x: 44, y: 16, width: 0.5, height: 4 },\r\n\r\n            ];\r\n\r\n            levelLayout.forEach(function(elem) {\r\n                var wall = new objects.Platform(elem.x, elem.y, elem.width, elem.height);\r\n                stage.addChild(wall.view);\r\n            });\r\n\r\n            // Add hero and enemy\r\n            this._hero = new objects.Hero(30, 520, false);\r\n            stage.addChild(this._hero.view);\r\n\r\n            this._enemy = new objects.Hero(770, 520, true);\r\n            stage.addChild(this._enemy.view);\r\n\r\n            // Add exit door\r\n            this._exitDoor = new objects.ExitDoor(36, 43);\r\n            stage.addChild(this._exitDoor.view);\r\n\r\n            //  scoreboard = new objects.Scoreboard();\r\n\r\n            var fixDef = new box2d.b2FixtureDef;\r\n            fixDef.density = 0.5;\r\n            fixDef.friction = 0.2;\r\n            fixDef.restitution = 0.5;\r\n\r\n            var bodyDef = new box2d.b2BodyDef;\r\n            var fixDefShape;\r\n\r\n            // Add event listener for collisions\r\n            var listener = new Box2D.Dynamics.b2ContactListener;\r\n            listener.BeginContact = this._evaluateCollision;\r\n            world.SetContactListener(listener);\r\n\r\n            // add this scene to the global stage container\r\n            stage.addChild(this);\r\n        }\r\n\r\n        // LEVEL Scene updates here\r\n        public update(): void {\r\n\r\n            this._hero.update();\r\n            this._enemy.update();\r\n\r\n            //   //  scoreboard.update();\r\n\r\n            reality.update();\r\n\r\n        }\r\n\r\n        // Reset the level\r\n        public reset(): void {\r\n            //TODO: this._hero.body.SetPosition does not work for some reason.\r\n        }\r\n\r\n\r\n        //EVENT HANDLERS ++++++++++++++++++++\r\n\r\n        // Treat collisions \r\n        protected _evaluateCollision(contact) {\r\n            var objA = contact.GetFixtureA().GetBody().GetUserData();\r\n            var objB = contact.GetFixtureB().GetBody().GetUserData();\r\n            if (objA && objB) {\r\n                var collided = [objA.objType, objB.objType];\r\n\r\n                //console.log('Collision between ' + objA.objType + ' and ' + objB.objType);\r\n\r\n                // Treat hero collisions\r\n                if (collided.indexOf('hero') > -1) {\r\n                    if (collided.indexOf('enemy') > -1) {\r\n                        console.log('You touched the enemy. Lose a life');\r\n                        currentScene.reset();\r\n                    } else if (collided.indexOf('exit door') > -1) {\r\n                        console.log('Level complete! You win!');\r\n                        currentScene.reset();\r\n                    }\r\n                } else if (collided.indexOf('enemy') > -1 && collided.indexOf('exit door') > -1) {\r\n                    console.log('The enemy reached the door. Lose a life.');\r\n                    currentScene.reset();\r\n                }\r\n            }\r\n        }\r\n    }\r\n}"],"sourceRoot":"/source/"}